# 開発用リポジトリのブランチ運用ルール

## 概要

本ドキュメントは、開発リポジトリ`plateau-web-app`におけるブランチ運用に関するドキュメントである。

## ブランチ

`plateau-web-app`リポジトリにおいては、以下のブランチを活用する。

| ブランチ種類     | 説明                                                                                                                               | 分岐元  | マージ先      |
| ---------------- | ---------------------------------------------------------------------------------------------------------------------------------- | ------- | ------------- |
| main             | 安定したバージョンのコードが保管される。プロダクトとしてリリースするためのブランチ。                                               | -       | -             |
| develop          | 開発中のコードが置かれる。リリース前はこのブランチが最新バージョンとなる。                                                         | -       | main          |
| feature branches | 新機能開発(バグ修正、リファクタリング含む)のために分岐する。                                                                       | develop | develop       |
| hotfix           | 本番バグの修正を行う。`main`ブランチから分岐する。                                                                                 | main    | main, develop |
| release          | プロダクトリリースの準備。 機能の追加やマイナーなバグフィックスとは独立させることで、 リリース時に含めるコードを綺麗な状態に保つ。 | develop | main, develop |

![gitflow](image/gitflow.png)

## フロー

### 開発

開発(新機能追加、バグ修正、リファクタリング)のフローは、`develop`ブランチから`feature`ブランチを作成し各種開発を行う。(基本的には issue からブランチ作成。)

タスク完了後、`develop`ブランチへマージする。
`docs`リポジトリ同様、プルリクを出しレビュー完了次第マージを行う。<br>

詳細な手順は[docs-branch-guideline.md](https://github.com/four-concealed-triples-pair-wait/docs/blob/draft/project-rules/docs-branch-guideline.md)の`具体的な手順`を参考。

### リリース準備

`release`ブランチを `develop`ブランチから作成し、リリース準備を行う。準備完了後、`main`にマージし、タグを付ける。その後、`develop`ブランチにもマージする。

### ホットフィックス

本番環境の重大なバグ修正には`hotfix`ブランチを`main`から作成する。修正後、`main`ブランチと `develop`ブランチの両方にマージし、タグをつける。

## ブランチ名の命名規則

1. ブランチが何をするのかを一目で理解できる名前にすること。

2. ブランチ名は通常小文字で書き、単語の間はダッシュ(-)で区切ること（例：`create-new-login-page`）。

3. ブランチの種類を示すプレフィックスを使用すること。`plateau-web-app`リポジトリでは以下のプレフィックスを使用する
   - feature branches
     - `feature/`：新規ドキュメントの追加、既存ドキュメントの修正を行うためのブランチ。
     - `bugfix/`：一般的なバグ修正を行うためのブランチ。`feature/`とは異なり、新機能開発ではなくバグの修正に特化している。
     - `refactor/`：コードのリファクタリングを行うためのブランチ。機能の変更なしに、コードのクリーンアップや構造の改善を目的とする。
   - `release/`：リリース準備のためのブランチ。
   - `hotfix/`：本番環境の緊急バグ修正を行うためのブランチ。

例えば新機能を追加するためのブランチであれば、以下のようになる。<br>
例：`feature/add-new-feature` <br>
`new-feature`のところは追加する機能を表す単語を入れる。
