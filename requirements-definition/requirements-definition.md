# 要件定義書

# 目的

- webサービスの開発を通して各々のスキルアップ
    - gitを活用したwebサービス開発経験
    - プログラミング言語、フレームワークの開発経験
    - AWS等のクラウドインフラ環境構築経験

- plateauを利用したwebゲームを通してカジュアルに楽しんでもらうこと

# 概要

## システム方式・構成

本システムは、クラウドベースの web アプリケーションとして構築する。<br>
詳細は他の要件が決定次第詰める。

## 利用者一覧
webサービスにアクセスし、本webサービスをプレイする人。

# 機能要件

## 1. ユーザ認証
### 1.1 ログイン
- ユーザーはメールアドレスとパスワードを使用してログインすることができる。
- 認証に失敗した場合、エラーメッセージを表示する。
### 1.2 ログアウト
- ユーザーはログアウトできる。
- ログアウト後、サイドバーのユーザー名とアイコンが未ログイン状態に更新される。
### 1.3 ユーザー登録
- 新規ユーザーはメールアドレス、ユーザー名、パスワードを入力してアカウントを作成することができる。
- 登録時の入力バリデーションを実施する。
<!-- - 登録完了時、ユーザーに確認メールを送信する。 -->
### 1.4 パスワード再設定
- ユーザーは、登録したメールアドレスを使用してパスワードを再設定することができる。
- パスワード再設定のリンクは一定時間のみ有効とする。

## 2. ゲームプレイ
### 2.1 ゲーム概要
- ユーザーは3D都市モデルの中に表示される目的のキャラクターを探し出す。
- プレイモードを選択できる。プレイモードは以下。
    <!-- 名称は後で考える -->
    - ノーマルモード(仮)
    - タイムアタック(仮)

#### 2.1.1 ノーマルモード
- 全20ステージ(仮)で構成される。
- ステージはどこでも選択可能。ステージによって難易度が異なる。
- ステージによって、以下の項目が変更される。
    - 都市モデル
    - 探す目標キャラクター
    - 目標キャラクター数

- プレイ中にゲームを途中終了、初めからやり直すことができる。

#### 2.1.2 タイムアタックモード
- 制限時間あり。制限時間が過ぎたらゲームが終了する。
- 見つけるまでの時間などを元にをゲームスコアを算出し、ラインキングとして表示される。
- ステージはノーマルモードのものと同様。

## 3. スコア・ランキング
### 3.1 スコア計算
- タイムアタックモードにおいて、ゲーム完了時にスコアが計算される。ゲームの残り時間、間違いの回数などに基づいてスコアを算出する。
### 3.2 ランキング表示
実装優先順位は総合ランキングを優先すること。
#### 3.2.1 総合ランキング
- 総合ランキングは各ステージのポイントの合計。
- ユーザーは自分のスコアとランキングを確認することができる。
- ランキング表において、表示するユーザーはランキング上位数名とプレイユーザー。
- 表示内容は以下
    - 順位
    - ユーザー名
    - スコア

#### 3.2.2 ステージごとのランキング
- ユーザーはステージ毎のスコアとランキングを表示することができる。
- ランキング表において、表示するユーザーはランキング上位数名とプレイユーザー。
- 表示内容は以下
    - 順位
    - ユーザー名
    - スコア

## 4. チュートリアル
- ユーザーがゲームのプレイ方法を理解するためのチュートリアルを用意すること。

## 5. 画面
### 5.1 ヘッダー
- サービス名, ユーザーアイコン, ランキングページへ遷移するアイコンが表示されること。
- ユーザーアイコンを押下して以下の画面遷移リンクが表示される。
    - ログイン
    - ログアウト
    - ユーザー情報

### 5.2 ホーム画面
- ゲームモードを選択後、ゲームプレイ画面へ遷移すること。
- ユーザーは「ゲーム開始」ボタンを押すと、新しいゲームを開始できること。

### 5.3 ゲームプレイ画面
- ゲーム開始前にカウントダウンを表示すること。
- 3d都市モデルが表示されていること。
- アバターが表示されていること。
- 探す目標のキャラクターのイラストが表示されていること。
- ゲーム画面は3D表示を行い、ユーザーの操作により視点を変更できる。
- ゲーム画面内には多数のアバターが表示される。
- 目的のキャラクター（「ウォーリー」のようなもの）も画面中にランダムに配置される。

#### 5.3.1 ノーマルモード画面
- ゲーム終了時に次のステージがアンロックされたことがわかること。そのまま次のステージをプレイするか選択できること。

#### 5.3.2 タイムアタック画面
- ゲーム中はプレイ開始時からの経過時間を表示すること。
- ゲーム終了時にゲームスコアを表示すること。
    - ログインしていた場合は、順位を表示すること。
- プレイヤーがログインしている場合、タイムアタックモードの自己ベストを表示すること。

### 5.4 ログイン画面
- メールアドレス, パスワードがテキストボックスに入力できること。
- 新規登録ボタンが表示されること。
- 新規登録ボタンがクリックされると, ユーザー登録画面に遷移すること
- 「パスワードを忘れた場合は?」のテキストが表示されること
- 「パスワードを忘れた場合は?」のテキストがクリックされると, パスワード再発行画面に遷移すること

### 5.5 ログアウト画面
- ホーム画面へ遷移すること。
- サイドバーのユーザー名とアイコンが未ログイン時のものになっていること

### 5.6 ユーザー登録画面
- ユーザー名, メールアドレス, パスワード, パスワード(確認用) がテキストボックスに入力できること
- 入力値に対してバリデーションし, 異常値に対してテキストボックスの下にアサートすること
    - 例: パスワードとパスワード(確認用)は同じ値であること
- 登録ボタンが表示されること
- 登録ボタンがクリックされると, メールアドレスがユニークであるか検索すること
    - ユニークでない場合, エラーを表示し, ユーザー登録画面から遷移しないこと
    - ユニークである場合, 登録完了画面に遷移すること
    - 登録されたメールアドレスに登録完了メールを送信すること
        - 登録完了メールの本文にはユーザー名を含むこと

### 5.7 登録完了画面
- 「ユーザー登録が完了しました」と表示されること
- 表示された 5 秒後に学習画面に遷移すること

### 5.8 パスワード再発行画面
- メールアドレスがテキストボックスに入力できること
- 送信ボタンが表示されること
- 送信ボタンがクリックされると, メールアドレスが登録済みであるか検索すること
    - 登録済みでない場合, エラーを表示し, パスワード再発行画面から遷移しないこと
    - 登録済みである場合, パスワード再設定メール送信完了画面に遷移すること
    - 入力されたメールアドレスにパスワード再設定用ページの URL を送信すること

### 5.9 パスワード再発行メール送信完了画面
- 「パスワード再設定用ページの URL を送信しました」と表示されること

### 5.10 パスワード再設定画面
- パスワード再発行メールの URL からのみ遷移すること
- パスワード, パスワード(確認用) がテキストボックスに入力できること
- 入力値に対してバリデーションし, 異常値に対してテキストボックスの下にアサートすること
    - 例. パスワードとパスワード(確認用)は同じ値であること
- 登録ボタンが表示されること
- 登録ボタンがクリックされると, パスワード再設定完了画面に遷移すること
    - 登録されたメールアドレスに再設定完了メールを送信すること
    - 再設定完了メールの本文にはユーザー名を含むこと

### 5.11 パスワード再設定完了画面
- 「パスワードの再設定が完了しました」と表示されること
- 表示された 5 秒後にホーム画面に遷移すること

### 5.12 ユーザー情報画面
- ヘッダーアイコンを押下して表示できるダイアログ
- 未ログイン時は以下の項目を表示すること
    - ログインボタン
    - 新規登録ボタン
- ログイン時は以下の項目を表示すること
    - ユーザー名
    - アイコン

## 6. SNS連携
- ゲームプレイ後、取得したスコアをSNS(Xなど)に投稿することができる。



# データ項目一覧
データベースに格納する項目とその属性の詳細を整理する
## 1. ユーザー情報
- ユーザーID: ユーザーを一意の識別するID
- メールアドレス: ユーザー認証やパスワード再設定に使用
- パスワード: 暗号化して保存すること
- ユーザー名: 表示用の名前
- アイコン画像: ユーザーのアイコンとして使用(オプショナル)
- 登録日時: ユーザーのアカウントが作成された日時
- 総合ベストスコア: ユーザーの総合ベストスコア
- ステージベストスコア: ユーザーの各ステージにおけるベストスコア
<!-- - 最終ログイン日時: ユーザーが最後にログインした日時 -->

## 2. ステージ情報
- ステージID: 一意の識別子
- ステージ名: ステージの名称
- 都市モデル: 3D都市モデルへのリンク or バイナリデータ
- 目的キャラクター: 
    - 名前: キャラクター名。
    - 画像: キャラクター画像。
    - 説明: キャラクターの簡単な説明。
- 目的キャラクター数: そのステージで探すべきキャラクターの数

## ３. 総合ランキング情報
- 総合ランキングID: 一意の識別子
- ユーザーID: ランキングに登録されているユーザーのID
- スコア: タイムアタックモードにおける各ステージのベストスコアの合計
- ランキング登録日時: スコアがランキングに登録された日時

## 4. ステージランキング情報
- ステージランキングID: 一意の識別子
- ユーザーID: ランキングに登録されているユーザーのID
- ステージID: 対象ステージのID
- スコア: タイムアタックモードにおける各ステージのベストスコア
- ランキング登録日時: スコアがランキングに登録された日時